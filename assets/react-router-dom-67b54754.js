import{r as e,a as D}from"./react-ce22c937.js";import{D as M,a as A,R as O,u as _}from"./react-router-83dacc51.js";/**
 * React Router DOM v6.18.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const j=e.createContext({isTransitioning:!1}),k=e.createContext(new Map),N="startTransition",y=D[N];function z(n){y?y(n):n()}class q{constructor(){this.status="pending",this.promise=new Promise((l,t)=>{this.resolve=u=>{this.status==="pending"&&(this.status="resolved",l(u))},this.reject=u=>{this.status==="pending"&&(this.status="rejected",t(u))}})}}function K(n){let{fallbackElement:l,router:t,future:u}=n,[a,x]=e.useState(t.state),[c,h]=e.useState(),[f,g]=e.useState({isTransitioning:!1}),[r,E]=e.useState(),[v,L]=e.useState(),[d,b]=e.useState(),p=e.useRef(new Map),{v7_startTransition:C}=u||{},T=e.useCallback(i=>{C?z(i):i()},[C]),F=e.useCallback((i,o)=>{let{deletedFetchers:s,unstable_viewTransitionOpts:m}=o;s.forEach(S=>p.current.delete(S)),i.fetchers.forEach((S,V)=>{S.data!==void 0&&p.current.set(V,S.data)}),!m||t.window==null||typeof t.window.document.startViewTransition!="function"?T(()=>x(i)):v&&r?(r.resolve(),v.skipTransition(),b({state:i,currentLocation:m.currentLocation,nextLocation:m.nextLocation})):(h(i),g({isTransitioning:!0,currentLocation:m.currentLocation,nextLocation:m.nextLocation}))},[t.window,v,r,p,T]);e.useLayoutEffect(()=>t.subscribe(F),[t,F]),e.useEffect(()=>{f.isTransitioning&&E(new q)},[f.isTransitioning]),e.useEffect(()=>{if(r&&c&&t.window){let i=c,o=r.promise,s=t.window.document.startViewTransition(async()=>{T(()=>x(i)),await o});s.finished.finally(()=>{E(void 0),L(void 0),h(void 0),g({isTransitioning:!1})}),L(s)}},[T,c,r,t.window]),e.useEffect(()=>{r&&c&&a.location.key===c.location.key&&r.resolve()},[r,v,a.location,c]),e.useEffect(()=>{!f.isTransitioning&&d&&(h(d.state),g({isTransitioning:!0,currentLocation:d.currentLocation,nextLocation:d.nextLocation}),b(void 0))},[f.isTransitioning,d]);let w=e.useMemo(()=>({createHref:t.createHref,encodeLocation:t.encodeLocation,go:i=>t.navigate(i),push:(i,o,s)=>t.navigate(i,{state:o,preventScrollReset:s==null?void 0:s.preventScrollReset}),replace:(i,o,s)=>t.navigate(i,{replace:!0,state:o,preventScrollReset:s==null?void 0:s.preventScrollReset})}),[t]),R=t.basename||"/",U=e.useMemo(()=>({router:t,navigator:w,static:!1,basename:R}),[t,w,R]);return e.createElement(e.Fragment,null,e.createElement(M.Provider,{value:U},e.createElement(A.Provider,{value:a},e.createElement(k.Provider,{value:p.current},e.createElement(j.Provider,{value:f},e.createElement(O,{basename:R,location:a.location,navigationType:a.historyAction,navigator:w},a.initialized?e.createElement(B,{routes:t.routes,state:a}):l))))),null)}function B(n){let{routes:l,state:t}=n;return _(l,void 0,t)}var P;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(P||(P={}));var I;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(I||(I={}));export{K as R};
